---
# =============================================================================
# Mandari 2.0 - Ansible Inventory
# =============================================================================
# This file is auto-generated from Terraform outputs.
# Run: terraform output -raw ansible_inventory > inventory/production.yml
# Or set environment variables: MASTER_IP, SLAVE_IP
# =============================================================================

all:
  vars:
    ansible_user: root
    ansible_python_interpreter: /usr/bin/python3
    ansible_ssh_common_args: '-o StrictHostKeyChecking=no'

    # Application settings
    app_name: mandari
    app_user: deploy
    app_dir: /opt/mandari
    data_dir: /mnt/data

    # Network settings
    private_network_cidr: "10.0.1.0/24"
    master_private_ip: "10.0.1.10"
    slave_private_ip: "10.0.1.11"

    # Docker settings
    docker_compose_version: "2.24.0"

    # PostgreSQL settings
    postgres_version: "16"
    postgres_max_connections: "200"
    postgres_shared_buffers: "2GB"
    postgres_effective_cache_size: "6GB"

    # Redis settings
    redis_version: "7"
    redis_maxmemory: "512mb"

    # Meilisearch settings
    meilisearch_version: "v1.6"

  children:
    master:
      hosts:
        mandari-master:
          ansible_host: "{{ lookup('env', 'MASTER_IP') | default('CHANGE_ME', true) }}"
          private_ip: "10.0.1.10"
          postgres_role: primary
          redis_role: master
          run_ingestor: true

    slave:
      hosts:
        mandari-slave:
          ansible_host: "{{ lookup('env', 'SLAVE_IP') | default('CHANGE_ME', true) }}"
          private_ip: "10.0.1.11"
          postgres_role: replica
          redis_role: replica
          run_ingestor: false

    # Convenience groups
    all_servers:
      children:
        master:
        slave:

    postgres_primary:
      hosts:
        mandari-master:

    postgres_replica:
      hosts:
        mandari-slave:

    web_servers:
      children:
        master:
        slave:
